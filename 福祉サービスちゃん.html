<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ä»‹è­·ãƒ»éšœå®³æ”¯æ´ãƒŠãƒ“ï¼ˆåœ°åŸŸå¯¾å¿œï¼‰</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: sans-serif; padding: 2rem; background: #f4f4f4; }
    .card { background: white; padding: 1.5rem; margin-bottom: 1.5rem; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    button { margin: 0.5rem; padding: 0.6rem 1.2rem; font-size: 1rem; cursor: pointer; }
    table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    th, td { border: 1px solid #ccc; padding: 0.6rem; text-align: left; }
    th { background: #eee; }
    .highlight { background: #fff9c4; font-weight: bold; }
    input[type="number"] { width: 100%; padding: 0.5rem; font-size: 1rem; margin-top: 0.5rem; }
  </style>
</head>
<body>

<h1>ä»‹è­·ãƒ»éšœå®³æ”¯æ´ãƒŠãƒ“ï¼ˆåœ°åŸŸå˜ä¾¡å¯¾å¿œï¼‰</h1>

<div id="question-area" class="card"></div>

<div id="disease-search-area" class="card" style="display:none;">
  <h3>åˆ¥è¡¨7å¯¾è±¡ç–¾æ‚£ï¼ˆæ¤œç´¢å¯ï¼‰</h3>
  <input type="text" id="disease-search" placeholder="ç–¾æ‚£åã‚’å…¥åŠ›">
  <table id="disease-table">
    <thead><tr><th>ç–¾æ‚£å</th><th>å‚™è€ƒ</th></tr></thead>
    <tbody>
      <tr><td>ç­‹èç¸®æ€§å´ç´¢ç¡¬åŒ–ç—‡ï¼ˆALSï¼‰</td><td>ç‰¹å®šç–¾ç—…</td></tr>
      <tr><td>æœ«æœŸã®æ‚ªæ€§è…«ç˜ï¼ˆãŒã‚“ï¼‰</td><td>ç·©å’Œã‚±ã‚¢å¯¾è±¡</td></tr>
      <tr><td>å¤šç³»çµ±èç¸®ç—‡</td><td>ãƒ‘ãƒ¼ã‚­ãƒ³ã‚½ãƒ³ç—‡å€™ç¾¤</td></tr>
      <tr><td>äººå·¥å‘¼å¸å™¨ä½¿ç”¨ä¸­</td><td>åŒ»ç™‚çš„ã‚±ã‚¢</td></tr>
    </tbody>
  </table>
</div>

<div id="result-area" class="card" style="display:none;"></div>

<div id="usage-input" class="card" style="display:none;">
  <h3>ğŸ“Š ä»Šæœˆã™ã§ã«ä½¿ã£ãŸå˜ä½æ•°ã‚’å…¥åŠ›</h3>
  <input type="number" id="used-units" placeholder="ä¾‹ï¼š10000">
  <div id="usage-result" style="margin-top:1rem;"></div>
</div>

<script>
let answers = {};
let step = 1;

// å„è¦ä»‹è­·åº¦ã®æ”¯çµ¦é™åº¦å˜ä½
const unitTable = {
  support1: 5216,
  support2: 10732,
  care1: 16765,
  care2: 19735,
  care3: 27048,
  care4: 30938,
  care5: 36217
};

// æ‰€å¾—åŒºåˆ†ã”ã¨ã®è² æ‹…å‰²åˆ
const incomeToCopay = {
  low: 0.1,
  mid: 0.2,
  high: 0.3,
  unknown: null
};

// è³ªå•ä¸€è¦§
const questions = {
  1: {
    text: "å¹´é½¢ã¯ï¼Ÿ",
    options: {
      "65æ­³ä»¥ä¸Š": () => { answers.age = "65+"; step++; showQuestion(); },
      "65æ­³æœªæº€": () => { answers.age = "under65"; step++; showQuestion(); }
    }
  },
  2: {
    text: "è¦ä»‹è­·èªå®šã‚’å—ã‘ã¦ã„ã¾ã™ã‹ï¼Ÿ",
    options: {
      "å—ã‘ã¦ã„ã‚‹": () => { answers.certified = true; step++; showQuestion(); },
      "å—ã‘ã¦ã„ãªã„": () => { answers.certified = false; step = 4; showQuestion(); }
    }
  },
  3: {
    text: "è¦ä»‹è­·åº¦ã¯ï¼Ÿ",
    options: {
      "è¦æ”¯æ´1": () => { answers.careLevel = "support1"; step++; showQuestion(); },
      "è¦æ”¯æ´2": () => { answers.careLevel = "support2"; step++; showQuestion(); },
      "è¦ä»‹è­·1": () => { answers.careLevel = "care1"; step++; showQuestion(); },
      "è¦ä»‹è­·2": () => { answers.careLevel = "care2"; step++; showQuestion(); },
      "è¦ä»‹è­·3": () => { answers.careLevel = "care3"; step++; showQuestion(); },
      "è¦ä»‹è­·4": () => { answers.careLevel = "care4"; step++; showQuestion(); },
      "è¦ä»‹è­·5": () => { answers.careLevel = "care5"; step++; showQuestion(); }
    }
  },
  4: {
    text: "å¹´åï¼ˆç›®å®‰ï¼‰ã‚’é¸ã‚“ã§ãã ã•ã„",
    options: {
      "éèª²ç¨ä¸–å¸¯ï¼ˆç”Ÿæ´»ä¿è­·å«ã‚€ï¼‰": () => { answers.copay = incomeToCopay.low; step++; showQuestion(); },
      "å¹´åç´„280ä¸‡å††æœªæº€": () => { answers.copay = incomeToCopay.low; step++; showQuestion(); },
      "å¹´å280ä¸‡ã€œ340ä¸‡å††": () => { answers.copay = incomeToCopay.mid; step++; showQuestion(); },
      "å¹´å340ä¸‡å††ä»¥ä¸Š": () => { answers.copay = incomeToCopay.high; step++; showQuestion(); },
      "ã‚ã‹ã‚‰ãªã„ / ä¸æ˜": () => { answers.copay = incomeToCopay.unknown; step++; showQuestion(); }
    }
  },
  5: {
    text: "åŒ»å¸«ã‹ã‚‰è¨ªå•çœ‹è­·ãŒå¿…è¦ã¨è¨€ã‚ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿ",
    options: {
      "ã¯ã„": () => { answers.needNurse = true; step++; showQuestion(); },
      "ã„ã„ãˆ": () => { answers.needNurse = false; step++; showQuestion(); }
    }
  },
  6: {
    text: "åˆ¥è¡¨7ã«è©²å½“ã™ã‚‹ç–¾æ‚£ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ",
    options: {
      "ã‚ã‚‹": () => { answers.specialDisease = true; step++; showQuestion(); },
      "ãªã„": () => { answers.specialDisease = false; step++; showQuestion(); }
    }
  },
  7: {
    text: "éšœå®³è€…æ‰‹å¸³ã‚’æŒã£ã¦ã„ã¾ã™ã‹ï¼Ÿ",
    options: {
      "ã‚ã‚‹": () => { answers.disabled = true; step++; showQuestion(); },
      "ãªã„": () => { answers.disabled = false; step++; showQuestion(); }
    }
  },
  8: {
    text: "ãŠä½ã¾ã„ã®åœ°åŸŸã¯ï¼Ÿ",
    options: {
      "æ˜¥æ—¥éƒ¨å¸‚ï¼ˆæ¨™æº–10.00å††ï¼‰": () => { answers.region = "kasukabe"; answers.unitPrice = 10.00; showResult(); },
      "æ±äº¬23åŒºãªã©ï¼ˆ10.14å††ï¼‰": () => { answers.region = "tokyo"; answers.unitPrice = 10.14; showResult(); },
      "åŒ—æµ·é“ã®ä¸€éƒ¨ï¼ˆ9.94å††ï¼‰": () => { answers.region = "hokkaido"; answers.unitPrice = 9.94; showResult(); },
      "ãã®ä»– / ä¸æ˜": () => { answers.region = "other"; answers.unitPrice = 10.00; showResult(); }
    }
  }
};

function showQuestion() {
  const area = document.getElementById("question-area");
  const diseaseArea = document.getElementById("disease-search-area");
  const q = questions[step];
  if (!q) return;

  let html = `<p><strong>Q${step}. ${q.text}</strong></p>`;
  for (let label in q.options) {
    html += `<button onclick="questions[${step}].options['${label}']()">${label}</button>`;
  }
  area.innerHTML = html;
  diseaseArea.style.display = (step === 6) ? "block" : "none";
}

function showResult() {
  const area = document.getElementById("question-area");
  const result = document.getElementById("result-area");
  const usageInput = document.getElementById("usage-input");
  const usageResult = document.getElementById("usage-result");

  area.style.display = "none";
  result.style.display = "block";
  usageInput.style.display = "block";

  const level = answers.careLevel;
  const copay = answers.copay;
  const unitPrice = answers.unitPrice || 10.00;
  const unitLimit = unitTable[level] || 0;
  const yen = unitLimit * unitPrice;
  const userPays = (copay != null) ? yen * copay : null;

  let html = `<h2>ğŸ“ åˆ¤å®šçµæœ</h2>`;
  if (unitLimit > 0) {
    html += `<p><strong>æ”¯çµ¦é™åº¦å˜ä½:</strong> ${unitLimit}å˜ä½ï¼æœˆ</p>`;
    html += `<p><strong>æ›ç®—é¡:</strong> ${yen.toLocaleString()}å††ï¼ˆ@${unitPrice.toFixed(2)}å††ï¼‰</p>`;
    html += (copay != null)
      ? `<p><strong>è‡ªå·±è² æ‹… ${copay * 100}%:</strong> ${userPays.toLocaleString()}å††ï¼æœˆ</p>`
      : `<p><strong>è‡ªå·±è² æ‹…å‰²åˆ:</strong> ä¸æ˜ã®ãŸã‚é‡‘é¡è¨ˆç®—ä¸å¯</p>`;
  } else {
    html += `<p>ä»‹è­·èªå®šãªã— or è¦æ”¯æ´æœªæº€ã®ãŸã‚ã€å˜ä½è¡¨ç¤ºãªã—</p>`;
  }

  result.innerHTML = html;

  // ã‚µãƒ¼ãƒ“ã‚¹ä¸€è¦§
  const services = [
    { name: "è¨ªå•ä»‹è­·", condition: answers.careLevel !== undefined, detail: "è¦ä»‹è­·ãƒ»è¦æ”¯æ´èªå®šã‚ã‚Š", note: "ç”Ÿæ´»æ´åŠ©ãƒ»èº«ä½“ä»‹è­·" },
    { name: "è¨ªå•çœ‹è­·", condition: answers.needNurse || answers.specialDisease, detail: "åŒ»å¸«ã®æŒ‡ç¤º or ç‰¹å®šç–¾æ‚£", note: "ä»‹è­·/åŒ»ç™‚ä¿é™º" },
    { name: "è¨ªå•å…¥æµ´ä»‹è­·", condition: ["care2","care3","care4","care5"].includes(answers.careLevel), detail: "è¦ä»‹è­·2ä»¥ä¸Š", note: "ãƒ˜ãƒ«ãƒ‘ãƒ¼+çœ‹è­·è·" },
    { name: "å®šæœŸå·¡å›ãƒ»éšæ™‚å¯¾å¿œå‹", condition: ["care3","care4","care5"].includes(answers.careLevel), detail: "è¦ä»‹è­·3ä»¥ä¸Š", note: "24æ™‚é–“å¯¾å¿œ" },
    { name: "é‡åº¦è¨ªå•ä»‹è­·ï¼ˆéšœå®³ï¼‰", condition: answers.disabled === true, detail: "éšœå®³è€…æ‰‹å¸³ï¼‹åŒ»çš„ã‚±ã‚¢ãªã©", note: "å¸¸æ™‚ä»‹è­·/åŒ»ã‚±ã‚¢å«ã‚€" },
    { name: "åŒè¡Œæ´è­·", condition: answers.disabled === true, detail: "è¦–è¦šéšœå®³ï¼‹æ‰‹å¸³ç­‰", note: "å¤–å‡ºæ”¯æ´" },
    { name: "è¡Œå‹•æ´è­·", condition: answers.disabled === true, detail: "çŸ¥çš„/ç²¾ç¥ï¼‹è¡Œå‹•éšœå®³", note: "å¤–å‡º/å±æ©Ÿå¯¾å¿œæ”¯æ´" },
    { name: "å±…å®…ä»‹è­·ï¼ˆãƒ›ãƒ¼ãƒ ãƒ˜ãƒ«ãƒ—ï¼‰", condition: answers.disabled === true, detail: "éšœå®³è€…æ‰‹å¸³æ‰€æŒ", note: "ç”Ÿæ´»æ´åŠ©ãƒ»èº«ä½“ä»‹è­·" },
    { name: "è‡ªè²»ã‚µãƒ¼ãƒ“ã‚¹", condition: true, detail: "æ¡ä»¶ãªã—", note: "å…¨é¡è‡ªå·±è² æ‹…" }
  ];

  let tableHTML = `
    <div class='card'>
      <h3>ğŸ“‹ åˆ©ç”¨å¯èƒ½ãªè¨ªå•ã‚µãƒ¼ãƒ“ã‚¹ä¸€è¦§</h3>
      <table>
        <thead><tr><th>ã‚µãƒ¼ãƒ“ã‚¹å</th><th>åˆ©ç”¨æ¡ä»¶</th><th>è£œè¶³</th></tr></thead><tbody>
  `;

  services.forEach(s => {
    const highlight = s.condition ? "highlight" : "";
    tableHTML += `<tr class='${highlight}'><td>${s.name}</td><td>${s.detail}</td><td>${s.note}</td></tr>`;
  });

  tableHTML += `</tbody></table></div>`;
  result.innerHTML += tableHTML;

  const input = document.getElementById("used-units");
  input.value = "";
  input.addEventListener("input", () => {
    const used = parseInt(input.value);
    if (isNaN(used) || unitLimit === 0) return usageResult.innerHTML = "";
    const remain = unitLimit - used;
    const remainYen = remain * unitPrice;
    const remainPay = (copay != null) ? remainYen * copay : null;
    usageResult.innerHTML = `
      <p>æ®‹ã‚Šå˜ä½ï¼š${remain}å˜ä½</p>
      <p>é‡‘é¡æ›ç®—ï¼š${remainYen.toLocaleString()}å††</p>
      <p>è‡ªå·±è² æ‹…ï¼š${remainPay != null ? remainPay.toLocaleString() + "å††" : "ä¸æ˜"}</p>
    `;
  });
}

// ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«è³ªå•é–‹å§‹
document.addEventListener("DOMContentLoaded", () => {
  const search = document.getElementById("disease-search");
  if (search) {
    search.addEventListener("input", () => {
      const val = search.value.toLowerCase();
      const rows = document.querySelectorAll("#disease-table tbody tr");
      rows.forEach(r => {
        const text = r.innerText.toLowerCase();
        r.style.display = text.includes(val) ? "" : "none";
      });
    });
  }
  showQuestion();
});
</script>
</body>
</html>


